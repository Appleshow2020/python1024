# python1024

# 🏐 피구 심판 보조 시스템

**카메라 기반 충돌 감지 및 아웃 판정 시스템**

## 🔍 프로젝트 개요
피구 경기장에 설치된 7개의 고성능 카메라(Raspberry Pi HQ Camera + 6mm 광각 렌즈)를 통해 
공의 위치, 속도, 방향 등을 실시간으로 분석하고, 충돌 여부 및 아웃 여부를 자동으로 판정하는 시스템입니다.

- **카메라 수**: 바닥 6대 + 천장 1대
- **목표 기능**:
  - 공의 3차원 위치 추정
  - 공 속도/가속도 계산
  - 충돌 감지 알고리즘
  - 자동 아웃 판정

## 🛠 시스템 구성

| 구성 요소       | 설명 |
|----------------|------|
| 카메라        | Raspberry Pi HQ Camera + 광각 6mm 렌즈 × 7대 |
| 제어 보드     | Raspberry Pi 4 Model B (8GB) × 7대 |
| 중앙 서버     | 고성능 데스크탑 |
| 통신 방식     | 유선 LAN / Gbps 스위치 허브 |
| 전원 공급     | PoE or 개별 전원 어댑터 |
| 동기화 방식   | PTP(Time Protocol) or GPIO 신호 |

## 📈 주요 알고리즘

### 1. 공 위치 삼각측량
> 2개 이상 카메라에서 동일 시간 프레임에 공이 감지되면, 위치를 3D로 계산

### 2. 가속도 변화량 기반 충돌 판정
> 시간별 가속도 변화량이 급격히 변하는 지점 → 충돌 가능성 높은 시점

### 3. 아웃 판정
> 충돌 지점이 경기장 경계선 바깥이고, 임계값 초과 시 아웃 판정

## 🎯 충돌 판정 지표표

| 지표 항목         | < 4     | 4 ~ 8   | 8 ~ 15  | 15 ~ 20 | 20 ~ 40 | 40 ~ 50 | 50 ~ 80 | ≥ 80    | T       | F       |
|------------------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|
| **가속도 변화량** | 🔴      | 🟧      | 🟨      | 🟩      | 🟩      | 🔵      | 🔵      | 🔵      | ⬜       | 🔴      |
| **충격 지속 시간** | 🔴      | 🟧      | 🟧      | 🟧      | 🟨      | 🟩      | 🔵      | 🔵       | ⬜       | 🔴      |
| **공과 인체의 거리** | 🔵      | 🟩      | 🟨      | 🟥      | 🟥      | 🟥      | 🟥      | 🟥      | 🟨      | 🔵      |
| **방향 반전 여부** |         |         |         |         |         |         |         |         | 🟩 (T)  | 🔴 (F)  |
| **선 접촉 여부**   |         |         |         |         |         |         |         |         | 🟨 (T)  | 🔴 (F)  |

> 🔵 매우 높은 확률  
> 🟩 높은 가능성  
> 🟨 애매한 상황  
> 🟧 낮은 가능성  
> 🔴 거의 없음  
> ⬜ 해당 없음 or 판단 불가  

---

### 🧠 종합 판단 방식

- 각 지표는 0~3점 스케일로 환산 가능 (🔴=0, 🟧=1, 🟨=2, 🟩=3, 🔵=4)
- `방향 반전 여부`, `선 접촉 여부`는 논리값(T/F)으로 가중치 부여
- 아래와 같은 방식으로 종합 판정 가능:
  - **충돌(HIT)**: 총합 점수 ≥ 임계값 (예: 10 이상)
  - **아웃(OUT)**: 선 접촉이 True일 경우 HIT와 무관하게 OUT 처리
  - **무효(MISS)**: 총합 점수가 낮고, 선 접촉/방향 반전 모두 False


---

📌 **이 지표들을 종합적으로 판단하여** `충돌` 또는 `아웃` 판정


> ※ 종합적으로 판단하여 "충돌" 또는 "아웃" 판정

## 📂 디렉토리 구조

```bash
python1024/
├── README.md
├── Multipose.py
├── UserInterface.py
└── main.py
